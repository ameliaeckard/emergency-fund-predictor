# Financial Fragility Prediction - ML Project

Predicting ability to cover $400 emergency expenses using machine learning analysis of SHED 2024 data.

## Project Overview

This project analyzes demographic and economic factors that predict whether individuals can cover a $400 emergency expense, revealing the "Glass Wallet" effect where certain populations face compounding financial barriers.

**Key Findings:**
- 83.6% accuracy in predicting emergency fund coverage
- Household size and age are strongest predictors
- Young adults (18-24) show only 32% coverage vs 62% overall
- Geographic disparities show 20+ percentage point gaps between states

## Repository Structure

```
EMERGENCY_FUND_PREDICTOR/
├── data/
│   ├── raw/
│   │   ├── fredgraph.csv              # FRED minimum wage data
│   │   ├── public2024.csv             # SHED 2024 survey data
│   │   ├── rpp1224.xlsx               # Regional Price Parities
│   │   └── SHED_2024codebook.pdf      # Variable descriptions
│   └── processed/                     # Generated by notebooks
├── notebooks/
│   ├── 01_data_exploration.ipynb      # EDA and visualizations
│   ├── 02_preprocessing.ipynb         # Data cleaning and feature engineering
│   ├── 03_model_training.ipynb        # Model training and comparison
│   └── 04_analysis.ipynb              # SHAP analysis and tuning
├── results/
│   └── figures/                       # Generated visualizations
├── src/
│   └── emergency_fund_predictor.ipynb # Original working code (if any)
├── requirements.txt
└── README.md
```

## Setup Instructions

### 1. Install Dependencies

```bash
pip install pandas numpy scikit-learn matplotlib seaborn plotly imbalanced-learn shap openpyxl
```

Or use requirements.txt:
```bash
pip install -r requirements.txt
```

### 2. Data Sources

**Primary Dataset:**
- [SHED 2024](https://www.federalreserve.gov/consumerscommunities/shed.htm) - Survey of Household Economics and Decisionmaking
  - 12,295 respondents
  - Place `public2024.csv` in `data/raw/`

**Supplementary Datasets:**
- [Regional Price Parities](https://www.bea.gov/data/prices-inflation/regional-price-parities-state-and-metro-area) - Bureau of Economic Analysis
  - State-level cost of living adjustments
  - Place `rpp1224.xlsx` in `data/raw/`

- [FRED State Minimum Wage Data](https://fred.stlouisfed.org/) - Federal Reserve Economic Data
  - Minimum wage by state
  - Place `fredgraph.csv` in `data/raw/`

### 3. Run Notebooks in Order

Execute notebooks sequentially, as each depends on the previous one's output:

1. **01_data_exploration.ipynb**
   - Loads and explores all datasets
   - Creates visualizations for report
   - No outputs saved (exploratory only)

2. **02_preprocessing.ipynb**
   - Merges datasets
   - Creates target variable (can cover $400)
   - Handles missing values
   - Saves processed data to `data/processed/`

3. **03_model_training.ipynb**
   - Trains 3 models: Logistic Regression, Random Forest, Gradient Boosting
   - Compares performance
   - Saves best model to `data/processed/`

4. **04_analysis.ipynb**
   - SHAP analysis for interpretability
   - Hyperparameter tuning
   - Final model evaluation
   - Generates figures for report

## Key Features Used

Based on SHED 2024 codebook:

**Demographics:**
- `ppage` - Age
- `pphhsize` - Household size
- `ppkid017` - Number of children under 18
- `ppeducat` - Education level
- `ppethm` - Race/ethnicity
- `ppgender` - Gender
- `ppinc7` - Household income

**Financial:**
- `EF1` - Has 3-month emergency fund
- `EF3_a` through `EF3_g` - Ways to cover $400 emergency

**State-Level Economics:**
- `pce_pct_change` - Personal consumption expenditure change
- `income_pct_change` - Real income change
- `real_income_2023` - Real income adjusted for cost of living

## Target Variable

**can_cover_400** (Binary: 0 or 1)
- **1 = Can cover**: Respondent selected any payment method for $400 emergency (EF3_a through EF3_g)
- **0 = Cannot cover**: Respondent selected none or only "couldn't pay" (EF3_h)

## Models Used

1. **Logistic Regression**
   - Baseline interpretable model
   - Good for understanding feature coefficients

2. **Random Forest**
   - Handles non-linear relationships
   - Provides feature importance

3. **Gradient Boosting** (Best Performer)
   - 83.6% accuracy, 0.859 F1, 0.910 ROC-AUC
   - Captures complex feature interactions
   - Used for final predictions

## Results Summary

### Model Performance
- **Best Model**: Gradient Boosting
- **Accuracy**: 83.6%
- **F1-Score**: 0.859
- **ROC-AUC**: 0.910
- **Cross-Validation F1**: 0.854 (±0.012)

### Top Predictive Features (SHAP Analysis)
1. Household size (pphhsize) - Negative impact
2. Age (ppage) - Positive impact
3. Children under 18 (ppkid017) - Negative impact
4. Education level (ppeducat) - Positive impact
5. Income category (ppinc7) - Positive impact

### Key Insights

**The "Glass Wallet" Effect:**
- Young families with multiple children face compounding disadvantages
- Geographic inequality: State variation shows 20+ percentage point gaps
- 41.8% of Americans cannot cover a $400 emergency

**Demographic Patterns:**
- Only 32% of 18-24 year olds can cover vs 62% overall
- Larger households struggle more (resources spread thin)
- Education and income show strong positive correlations

**Policy Implications:**
- Target assistance to young families with children
- Address geographic wage disparities
- Improve financial literacy programs
- Enhance data collection on minimum wage impacts

## Troubleshooting

**Issue: Column not found errors**
- Ensure you're using SHED 2024 data (not 2023 or earlier)
- Column names may vary by dataset version
- Check codebook for exact variable names

**Issue: State merge produces NaN values**
- Some states may have missing RPP data
- Preprocessing notebook fills these with national median

**Issue: Memory errors**
- SHED dataset has 12,295 rows - should run on most systems
- If needed, reduce sample size in data exploration

## Citation

If using this code or methodology, please cite:

```
Board of Governors of the Federal Reserve System. 
Survey of Household Economics and Decisionmaking [dataset]. 
Washington: Board of Governors, 2025. 
https://doi.org/10.17016/datasets.002
```

## Author

Amelia - UNC Charlotte
Junior Computer Science Student
Concentration: AI, Robotics, and Gaming

## Acknowledgments

- SHED 2024 data: Federal Reserve Board
- RPP data: Bureau of Economic Analysis  
- FRED data: Federal Reserve Economic Data
- AI assistance: Claude (Anthropic) for debugging and code optimization
- Kode with Klossy (KWK) program for project foundation

## License

Educational project - data usage subject to Federal Reserve SHED terms of use.
